"use strict";requirejs(["controller","connectingScreen","connectionErrorScreen","connectionLostScreen","characterScreen","controlScreen","utils","constants"],function(e,n,t,o,c,i,r,s){function a(e){e!==E&&(E&&r.addClass(E,"hidden"),E=e,r.removeClass(E,"hidden"))}function u(){a(n.getScreenElement()),r.requestFullscreen(document.body),l.disconnect();var e=s.HOST_STRING_TEMPLATE.replace("{0}",r.getCookie(s.HOST_NAME_COOKIE,s.DEFAULT_HOST));console.log("connect to",e),l.connect(e,r.getCookie(s.USER_NAME_COOKIE,s.DEFAULT_USER_NAME))}function d(){var e=document.getElementById("portrait-warning");l.isInputDisabled()?r.addClass(e,s.INPUT_DISABLED_CLASS):r.removeClass(e,s.INPUT_DISABLED_CLASS)}navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate||function(){console.log("vibrate not supported by browser")};var l=new e,E=n.getScreenElement();if(l.onConnect=function(){a(c.getScreenElement())},l.onDisconnect=function(){navigator.vibrate(250),a(o.getScreenElement())},l.onMessage=function(e){"deathCounter"in e&&(document.getElementById("deaths").innerHTML=e.deathCounter),"timer"in e&&(document.getElementById("timer").innerHTML=e.timer)},l.onError=function(e){console.error("Error during connection:",e),a(t.getScreenElement())},l.addAction(document.getElementById("thrust")),l.addAction(document.getElementById("break")),s.TOUCH_CONTROL){var g=document.getElementById("thrust");g.addEventListener("mousemove",function(e){var n=e.offsetX,t=n/g.offsetWidth*2-1;l.setAxis(t)})}n.init(),t.init(),o.init(),c.init(),i.init(),n.success=function(){a(c.getScreenElement())},n.fail=function(){l.disconnect(),a(t.getScreenElement())},t.success=function(){u()},c.success=function(e,n,t,o){l.startGame(e,n,t,o),r.requestFullscreen(document.body),a(i.getScreenElement())},i.success=function(){l.disconnect()},i.fail=function(){},i.ping=function(){l.sendMessage(JSON.stringify({type:s.MESSAGE_TYPE_PING}))},o.success=function(){u()},o.fail=function(){a(t.getScreenElement())},window.setInterval(l.sendInput,s.UPDATE_RATE),window.addEventListener("orientationchange",d),r.lockLandscapeOrientation(),u()});